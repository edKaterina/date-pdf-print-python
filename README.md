# date-pdf-print-python
# Алгоритм нахождения строки для вставки даты по типу документа

В файле settings.py закомментированы несколько документов для тестов особенностей документов

Особенности:
+ Документ может быть повернут на 0-10 градусов
+ Документы ТрН разных форматов
+ Разные размеры строк в блоке для вставки даты

Типы:

+ ТТН - Товарно-транспортная накладная(дата пишется в 3ю строку от слова "Сдача")

+ ТрН - Товарная накладная(дата пишется в 4ю строку от слова "прибытия")

Описание алгоритма

1. Загрузка ORC и изображения по его ключу
2. Определение типа документа (на данный момент тип напрямую указывается в settings.py, после нужно привязываться к documentType)
3. Создание структуры линий файла модулем OpenCV
4. Поиск ближайшей слева вертикальной линии(столбца) исходя из положения определяющего слова(слово привязано к типу)
5. Поиск n-й строки относительно от точки пункта 4, попиксельный поиск строки, строки шириной в несколько пикселей учтены
6. Отрисовка напрвляющей по оси от (0,0) до нужной точки по координатам столбца и строки

Файл результата test.png в корне проекта

При вставке текста нужно указать отступ по осям в зависимости от шрифта 

Запуск осуществлять из файла main.py, остальные файлы и директории сохранены для обучения